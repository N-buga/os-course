\section{Основное задание}

В этом домашнем задании вам необходимо научиться создавать/завершать/планировать
потоки исполнения, а также реализовать простую синхронизацию потоков исполнения.

С появлением потоков, вам придется внести изменения в уже написанный код, так
чтобы он стал потокобезопасным. Скорее всего вам понадобится исправить алокатор
страниц и алокатор объектов фиксированного размера (SLAB).

Для всех заданий должны быть предусмотрены тесты, т. е. создание потоков,
использование взаимного исключения, переключение потоков и завершение потоков -
все эти функции должны быть использованы в тестах.

\begin{enumerate}
  \item Реализовать примитив взаимного исключения потоков.
  \item Реализовать планировщик потоков и организовать вытесняющую
        многозадачность. Т. е. другими словами, реализовать функцию, которая
        приостанавливает текущий поток исполнения и вместо него ставит на
        процессор другой поток исполнения (если таковой имеется), и вызвать эту
        функцию из обработчика прерывания таймера, после того как поток
        выработает свой квант времени.
  \item Реализовать функции управления потоками. Конкретный интерфейс остается
        на ваше усмотрение, главное чтобы можно было создавать новые потоки,
        завершать потоки и дожидаться завершения других потоков.
\end{enumerate}

Задания 2 и 3 очень тесно связаны друг с другом - действительно довольно
бессмысленно создавать потоки, если вы не умеете передавать им управление.
Поэтому, задание 3 без выполненного задания 2 не засчитывается. Обратное,
впрочем, возможно, т. е. можно выполнить задание 2, не выполнив до конца
задание 3.

\section{Дополнительные задания}

\begin{enumerate}
  \item Реализация блокирующего примитива взаимного исключения (то, что обычно
        называют mutex-ом). В отличие от примитива взаимного исключения в
        основном задании, если mutex был захвачен, когда поток попытался
        выполнить lock на нем, этот поток должен быть погружен в "сон" до тех
        пор, пока держатель mutex-а не выполнит на нем unlock\footnote{Имена
        функций и названия структур остаются на ваше усмотрение, но семантика
        погружения потока в сон должна оставаться.}.
  \item Реализовать условную переменную (conditional variable, для примера
        смотрите pthread\_cond\_t) и соответствующие функции для работы с ней:
    \begin{itemize}
      \item wait - ожидать, пока кто-нибудь не посигналит на условной
            переменной;
      \item signal - посигналить одному из потоков ожидающих на условной
            переменной;
      \item broadcast - посигналить всем потокам ожидающим на условной
            переменной;
    \end{itemize}
\end{enumerate}

Как и для основного задания, для дополнительного задания должны быть
какие-нибудь тесты.
